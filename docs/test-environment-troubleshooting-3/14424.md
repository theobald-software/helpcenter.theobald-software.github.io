# DeltaQ Troubleshooting Guide

<!--html--><div>This article lists common errors, pitfalls and problems when setting up or running DeltaQ.&nbsp;</div><div>This article is extended on a regular basis.</div><div><br></div><div><br></div><div>--------------------</div><div>
<h3>Error:</h3><div>When running a DeltaQ extraction you see lots of entries like the following in SAP transaction SM58</div><br><code><div><span style="color: inherit; font-size: inherit;">IDOC_INBOUND_ASYNCHRONOUS: „Error when opening an RFC connection
(CPIC-CALL : 'ThSAPOCMINIT', commu Message No. </span><span style="color: inherit; font-size: inherit;">SR053 “.</span></div></code><br><div><span style="color: inherit; font-size: inherit;">or</span></div><code><div><span style="color: inherit; font-size: inherit;"><br></span></div><div><span style="color: inherit; font-size: inherit;">RSAR_TRFC_DATA_RECEIVED: </span>
<div><span style="color: inherit; font-size: inherit;">„Error when opening an RFC connection
(CPIC-CALL : 'ThSAPOCMINIT', commu Message No. </span><span style="color: inherit; font-size: inherit;">SR053 “.</span></div></div></code><div><span style="color: inherit; font-size: inherit;"><br></span></div><div><span style="color: inherit; font-size: inherit;">In the SM37 job log, you see entries like <code>ARFCSTATE = CPICERR</code>.<br></span>
</div>
<br>
<h3>Reason:</h3>SAP tries to send tRFC data packages and IDocs to an SAP Gateway (as specified in the Gateway Host setting of the RFC destination in SM59). Usually, DeltaQ component should have registered an RFC server program on that gateway. For some reason, the required server program is not registered on that gateway.<br>
<div><br></div><div>
One possible reason for this error is, that the Gateway host as specified in the DeltaQ component differs from the one specified in SM59.</div><div><br></div><h3>Solution:</h3></div><div>Make sure the 
 Gateway host as specified in the DeltaQ component matches the one specified in SM59.

</div><div><br></div><div>
<div><span style="font-size: 14px;">------------------------------------</span></div><div>
<h3>Error:</h3><div>When running an extraction with update mode 'D' (Delta), the extraction throws the following error message:<br></div>
<div><br>
</div>
<div><span style="font-size: 12pt;"><code>Some of the initialization requirements have not been completed.</code></span></div><div><span style="font-size: 12pt;"><code>Message ID:RSQU; Message Type:E; Message No:020<br></code></span></div>
<div><br>
</div><br><h3>Reason:</h3>You may have performend multiple inits on the DataSource, i.e. you ran the extraction with update mode 'C' (init) multiple times.<br><div><br>
</div><h3>Solution:</h3><div>Go to the DeltaQ's "Extraction Settings".</div><div>Click on the&nbsp; [Maintenance] button.</div><div>You should be seeing multiple entries, each entry representing an initialization of the DataSource.</div><div>Delete all entries but the oldest.</div><div>Close all windows and run extraction with update mode 'D'.<br></div>
</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;"><br></span>
</div>
<div>
<span style="font-size: 14px;">------------------------------------</span>
</div><h3>Error:</h3><div>When using NW RFC library you get the following error during DeltaQ extraction:</div><div><br></div><div>
<span style="font-size: 12pt;"><code>ERPConnect.CommunicationException:
RfcListenAndDispatch failed(RFC_SERIALIZATION_FAILURE): Incompatible parameter
type RFCTYPE_BYTE for parameter I_S_HEADER, type RFCTYPE_STRUCTURE is expected.</code></span>
</div><div><br></div><div>When using Classic RFC library, the extraction log shows entries like "No progress for n seconds, but 
data is not complete yet. Waiting…" which eventually results in a 
timeout.

</div>
<div><br>
</div><h3>Reason:</h3><div>On newer SAP releases such as S/4 2023, the default serializer setting for the RFC destination <u>is not</u> set to <i>Classic serializer</i>. <br></div><div>On RFC level, data is transmitted in a way the DeltaQ component can't handle.<br></div><div><br></div><h3>Solution:</h3><div>Go to SAP transaction SM59.</div><div>Edit the RFC destination, e.g. XTRACT01, that you created during DeltaQ customizing.</div><div>Go to <i>Special Options </i>tab. Find the <i>Select Protocal </i>setting at the bottom and change the <i>Serializer </i>setting to <i>Classic serializer</i>.<br></div>
</div><div><br></div><div><br></div><div><br>
<span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>The extraction log shows entries like "No progress for n seconds, but data is not complete yet. Waiting…" which eventually results in a timeout.</div><div><br></div><h3>Reason:</h3><div>This happens, when the extraction job on the SAP side is finished (SM37) but IDocs and/or tRFC data packages get stuck on the SAP side or were sent to a different RFC destination.&nbsp;</div><div><br></div><h3>Solution:</h3><div>List of possible causes and solutions:</div><div><ul><li>You are running DeltaQ extractions on the same RFC destination in parallel. Go to transaction SMQS and increase the Max.Conn. value to at least 10. With single DeltaQ extractions, that value should be at least 2.</li><li>You are running DeltaQ extractions on the same RFC destination (e.g. XTRACT01) in parallel from different computers. In this case IDocs and data packages are sent to the wrong computer.</li><li>If only data packages are coming through but no IDocs, go to transaction WE20, select your RFC destination (under Partner Type LS), double click on RSINFO and RSSEND and change the output mode to Transfer IDoc Immed.</li><li>The gateway host / gateway service settings in SM59 are not maintained properly. If you have a message server try to insert the message server details there, if not, put in the application server. Check carefully that these settings fit to the entries in the DeltaQ dialog.</li><li>You are running SAP’s auxiliary test program called “rfcexec”. This program intercepts outgoing IDocs/tRFC calls. Stop this program.</li><li>Check SAP note 2556150 - "Transaction Recorded" status in transaction SM58<br></li></ul></div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>The output contains crippled characters, especially non-latin characters, e.g., Chinese, Czech, etc.</div><div><br></div><h3>Solution:</h3><div>Go to transaction SM59 and change the unicode flag from non-Unicode to Unicode.</div><div><br></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>The extraction log shows a number of "No job found in SAP" entries.</div><div><br></div><h3>Solution:</h3><div>Go to transaction WE20, select your RFC destination (under Partner Type LS) and check the Part. Status on the Classification tab. The status needs to be Active.</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>I get an “Error in Data Selection” from SAP</div><div><br></div><h3>Solution:</h3><div>If you use selection values, check if the values are formatted properly. If this error only happens during delta updates, check if your OLTP source is able to handle delta updates (see transaction RSA2 for details). If this doesn’t help, check the log output of the job in transaction SM37.</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>During extraction the error “Not Authorized for XXX” appears even though all authority objects listed in the knowledge base article <a href="https://kb.theobald-software.com/sap/authority-objects-sap-user-rights" target="_blank">Authority Objectst</a>&nbsp;are applied.</div><div><br></div><h3>Solution:</h3><div>Some extractors add additional authority checks within the extractor that are not foreseeable. So the missing authority objects must be added.</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>SSIS Project Connection Manager vs. Package Connection Manager with parallel DeltaQ extractions.</div><div><br></div><h3>Solution:</h3><div>When running DeltaQ extractions within one SSIS package in parallel, we recommend using a package connection manager for each DeltaQ component. A single project connection manager may work, as well. However, with short interval scheduling and heavy parallelism, dedicated package connection managers will add to extraction stability.</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><br></div><h3>Error:</h3><div>When doing the DeltaQ Customizing Step 3 (RSAP_BIW_CONNECT_40 ) a PORT_CREATION_ERROR pops up in transaction SE37.</div><div><br></div><h3>Solution:</h3><div>Refer to the knowledge base article <a href="https://support.theobald-software.com/helpdesk/KB/View/13346-deltaq-customizing-port-creation-error" target="_blank">DeltaQ Customizing - PORT_CREATION_ERROR</a>.</div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>The customizing check shows red indicators that are not related to missing authority objects.</div><div><br></div><h3>Solution:</h3><div><ul><li>The steps of customizing a DeltaQ are not done properly in SAP. Start from the beginning and do exactly what is written in the <a href="https://help.theobald-software.com/en/xtract-is/sap-customizing/customizing-for-deltaq" target="_blank">documentation</a>. If an error occurs during a step don’t consider the step as done.</li><li>Registration of RFC server program is not allowed on the SAP gateway. Refer to the knowledge base article <a href="https://kb.theobald-software.com/sap/registering-rfc-server-in-sap-releases-in-kernel-release-720-and-higher" target="_blank">Registering RFC Server in SAP Releases in Kernel Release 720 and higher</a>.</li></ul></div><div><span style="font-size: 14px;"><br></span></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>The RFC connection check in SAP transaction SM59 fails.</div><div><br></div><h3>Solution:</h3><div>Refer to the knowledge base article&nbsp;<a href="https://support.theobald-software.com/helpdesk/KB/View/13345-sm59-rfc-connection-test-fails" target="_blank">SM59 RFC - Connection Test fails</a>.</div><div><br></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>Error after SAP system upgrade</div><div><br></div><h3>Solution:</h3><div>If the error message is similar to "Error while trying to obtain information about source and destination in table RSBASIDOC..Object ERPCLN800 / XTRACT01 inactive", refer to<span style="font-size: 14px;">&nbsp;<a href="https://help.theobald-software.com/en/xtract-is/sap-customizing/customizing-for-deltaq#5-execute-function-module-rsas_rbwbcrl_store" target="_blank">Customizing for DeltaQ</a> and perform step 5 (execute RSAS_RBWBCRL_STORE).</span></div><div><span style="font-size: 14px;"><br></span></div><div><div style="font-size: 14px;"><span style="font-size: 14px;">------------------------------------</span><br>
</div><br></div><h3>Error:</h3><div>RFC server test failed: Error when opening an RFC connection (CPIC-CALL: ‘ThSAPOCMINIT’, communication rc: CM_ALLOCATE_FAILURE_RETRY (cmRc=2)).</div><div><br></div><h3>Solution:</h3><div>Make sure, the RFC server program, e.g. XTRACT01, is allowed to register on the SAP gateway, see&nbsp;<a href="https://kb.theobald-software.com/sap/registering-rfc-server-in-sap-releases-in-kernel-release-720-and-higher" target="_blank">Registering RFC Server in SAP Releases in Kernel Release 720 and higher</a>.</div><div>In some SAP Releases asynchronous communication between external partner e.g., Xtract Universal and/or Xtract IS and RFC-Destination can lead to above mentioned error message, although all customizing steps have done properly. Make sure to either use the full-qualified-name (FQN) or IP address of the SAP Gateway Host in all involved systems.</div><div><br></div><div><span style="font-size: 14px;">------------------------------------</span><br></div><div><span style="font-size: 14px;"><br></span></div><h3>Error:</h3><div>Error "ISOURCE_NOT_EXIST or GENERATION_ERROR" appears when activating a DataSource.</div><div><br></div><h3>Solution:</h3><div>Re-run the function module RSAS_RBWBCRL_STORE as described in the <a href="https://help.theobald-software.com/en/xtract-is/sap-customizing/customizing-for-deltaq" target="_blank">DeltaQ customizing guide</a>.</div><div><br></div><div>
<span style="font-size: 14px;">------------------------------------</span><br></div>